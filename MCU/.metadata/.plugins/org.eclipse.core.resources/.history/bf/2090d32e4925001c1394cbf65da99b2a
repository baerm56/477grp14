#include "speaker.h"

void SpeakerGPIOInit(){
	GPIO_InitTypeDef GPIO_InitStruct;

	// Enable Analog Output
	SPEARER_GPIO_BUS_ENABLE_FUNCTION;

	GPIO_InitStruct.Pin = SPEAKER_GPIO_PIN;
	GPIO_InitStruct.Mode = GPIO_MODE_ANALOG;
	GPIO_InitStruct.Pull = GPIO_NOPULL;
	HAL_GPIO_Init(SPEAKER_GPIO, &GPIO_InitStruct);
}


void SpeakerInit(DAC_HandleTypeDef * DAC_Config){
	DAC_ChannelConfTypeDef sConfig = {0};

	SpeakerGPIOInit();

	// Enable DAC clock
	__HAL_RCC_DAC_CLK_ENABLE();
	DAC_Config->Instance = DAC;
	HAL_DAC_Init(DAC_Config);

	// DAC Setup Settings of Timer 2 Trigger
	sConfig.DAC_Trigger = DAC_TRIGGER_T2_TRGO;
	sConfig.DAC_OutputBuffer = DAC_OUTPUTBUFFER_ENABLE;
	HAL_DAC_ConfigChannel(DAC_Config, &sConfig, DAC_CHANNEL_1);
}

