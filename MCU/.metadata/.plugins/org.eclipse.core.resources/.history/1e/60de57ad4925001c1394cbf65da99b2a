#include "speaker.h"

void SpeakerGPIOInit(){
	GPIO_InitTypeDef GPIO_InitStruct;

	// Enable Analog Output
	SPEARER_GPIO_BUS_ENABLE_FUNCTION;

	GPIO_InitStruct.Pin = SPEAKER_GPIO_PIN;
	GPIO_InitStruct.Mode = GPIO_MODE_ANALOG;
	GPIO_InitStruct.Pull = GPIO_NOPULL;
	HAL_GPIO_Init(SPEAKER_GPIO_BUS, &GPIO_InitStruct);
}

void DACInit(DAC_HandleTypeDef * hdac){
	DAC_ChannelConfTypeDef sConfig = {0};

	// Enable DAC clock
	__HAL_RCC_DAC_CLK_ENABLE();
	hdac->Instance = DAC;
	HAL_DAC_Init(hdac);

	// DAC Setup Settings of Timer 2 Trigger
	sConfig.DAC_Trigger = DAC_DMA_TRIGGER;
	sConfig.DAC_OutputBuffer = DAC_OUTPUTBUFFER_ENABLE;
	HAL_DAC_ConfigChannel(hdac, &sConfig, DAC_CHANNEL);
}


void SpeakerInit(DAC_HandleTypeDef * hdac){
	SpeakerGPIOInit();
	DACInit(hdac);
}

